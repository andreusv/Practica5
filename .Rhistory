ggplot(th, aes(x=temp, y=hum)) + stat_density(aes(fill = p))
ggplot(th, aes(x=temp, y=hum)) + stat_density(aes(y=hum, fill = p))
ggplot(th, aes(x=temp, y=hum)) + stat_density(fill = p))
ggplot(th, aes(x=temp, y=hum)) + stat_density(aes(fill = p))
ggplot(th, aes(x=temp, y=hum)) + geom_raster(aes(fill = p), interpolate = TRUE)
ggplot(th, aes(x=temp, y=hum)) + geom_tile(aes(fill = p), interpolate = TRUE)
ggplot(th, aes(x=temp, y=hum)) + geom_tile(aes(fill = p), interpolate = TRUE, linejoin = "round")
ggplot(th, aes(x=temp, y=hum)) + geom_tile(aes(fill = p), linejoin = "round")
ggplot(th, aes(x=round(temp), y=round(hum))) + geom_tile(aes(fill = p), linejoin = "round")
ggplot(th, aes(x=round(temp), y=round(hum))) + geom_raster(aes(fill = p), linejoin = "round")
ggplot(th, aes(x=round(temp), y=round(hum))) + geom_raster(aes(fill = p), interpolate = TRUE)
ggplot(th, aes(x=round(temp), y=round(hum))) + geom_raster(aes(fill = p), interpolate = FALSE)
ggplot(th, aes(x=round(temp), y=round(hum))) + stat_density(aes(fill = p), geom = "raster", position = "identity")
ggplot(th, aes(x=round(temp), y=round(hum))) + geom_raster(aes(fill = p), linejoin = "round")
plot_ly(data = th, x = ~temp, y = ~hum, z = ~p) %>% add_heatmap() %>% layout(xaxis = list(title = "Temperature"), yaxis = list(title = "Humidity")) %>% colorbar(title="Cuantity")
ggplot(th, aes(x=round(temp), y=round(hum))) + geom_raster(aes(fill = p, width = 10), linejoin = "round")
ggplot(th, aes(x=round(temp), y=round(hum))) + geom_raster(aes(fill = p, width = 20), linejoin = "round")
ggplot(th, aes(x=round(temp), y=round(hum))) + geom_tile(aes(fill = p, width = 20), linejoin = "round")
ggplot(th, aes(x=round(temp), y=round(hum))) + geom_tile(aes(fill = p, width = 10), linejoin = "round")
ggplot(th, aes(x=round(temp), y=round(hum))) + geom_tile(aes(fill = p, width = 10, height = 10))
ggplot(th, aes(x=round(temp), y=round(hum))) + geom_tile(aes(fill = p, width = 5, height = 5))
ggplot(th, aes(x=round(temp), y=round(hum))) + geom_tile(aes(fill = p, width = 10, height = 10))
ggplot(th, aes(x=round(temp), y=round(hum))) + geom_tile(aes(fill = p, width = 10, height = 10)) + geom_rug()
ggplot(th, aes(x=round(temp), y=round(hum))) + geom_tile(aes(fill = p, width = 10, height = 10)) + geom_rug(alpha = 0.1)
ggplot(th, aes(x=temp, y=hum)) + geom_tile(aes(fill = p, width = 10, height = 10)) + geom_rug(alpha = 0.1)
ggplot(th, aes(x=temp, y=hum)) + geom_tile(aes(fill = p, width = 10, height = 10)) + geom_rug(alpha = 0.01)
g <- ggplot(th, aes(x=temp, y=hum)) + geom_tile(aes(fill = p, width = 10, height = 10)) + geom_rug(alpha = 0.01)
ggplotly(g)
g <- ggplot(th, aes(x=temp, y=hum)) + geom_tile(aes(fill = p)) + geom_rug(alpha = 0.01)
ggplotly(g)
g
ggplot(th, aes(x=temp, y=hum)) + geom_tile(aes(fill = p, width = 10, height = 10)) + geom_rug(alpha = 0.01)
library(tictoc)
sampled <- sample_n(days_since, 40)
temp <- sampled$temp
hum <- sampled$hum
th <- inner_join(data.frame(temp),data.frame(hum), by=character())
th$p <- 0
tic("entra")
for(i in 1:nrow(th)){
r <- days_since
r[["temp"]] <- th[["temp"]][i]
r[["hum"]] <- th[["hum"]][i]
sal <- predict(rf, r)
th[["p"]][i] <- sum(sal) / nr
}
toc()
ggplot(th, aes(x=temp, y=hum)) + geom_tile(aes(fill = p, width = 10, height = 10)) + geom_rug(alpha = 0.01)
ggplot(th, aes(x=temp, y=hum)) + geom_tile(aes(fill = p, width = 10, height = 10)) + geom_rug(alpha = 0.01)
ggplot(th, aes(x=temp, y=hum)) + geom_tile(aes(fill = p, width = 10, height = 15)) + geom_rug(alpha = 0.01)
library(dplyr)
library(plotly)
library(reshape2)
library(lubridate)
library(randomForest)
setwd("/Users/cmonserr/OneDrive - UPV/Trabajo_2/Asignaturas/Evaluacion de modelos/Practicas/Practica 3/Bike-Sharing-Dataset")
days <- read.csv("day.csv")
hour <- read.csv("hour.csv")
days$dteday <- as_date(days$dteday)
days_since <- select(days, workingday, holiday, temp, hum, windspeed, cnt)
days_since$days_since_2011 <- int_length(interval(ymd("2011-01-01"), days$dteday)) / (3600*24)
days_since$SUMMER <- ifelse(days$season == 3, 1, 0)
days_since$FALL <- ifelse(days$season == 4, 1, 0)
days_since$WINTER <- ifelse(days$season == 1, 1, 0)
days_since$MISTY <- ifelse(days$weathersit == 2, 1, 0)
days_since$RAIN <- ifelse(days$weathersit == 3 | days$weathersit == 4, 1, 0)
days_since$temp <- days_since$temp * 47 - 8
days_since$hum <- days_since$hum * 100
days_since$windspeed <- days_since$windspeed * 67
rf <- randomForest(cnt~., data=days_since)
results <- select(days_since, days_since_2011, temp, hum, windspeed, cnt)
nr <- nrow(days_since)
for(c in names(results)[1:4])
{
for(i in 1:nr){
r <- days_since
r[[c]] <- days_since[[c]][i]
sal <- predict(rf, r)
results[[c]][i] <- sum(sal) / nr
}
}
p1 <- ggplot(days_since, aes(x=days_since_2011, y=results$days_since_2011)) + geom_line() +ylim(c(0,6000))+ geom_rug(alpha = 0.1, sides = "b") + ylab("Prediction") + xlab("Days since 2011")
p2 <- ggplot(days_since, aes(x=temp, y=results$temp)) + geom_line() +ylim(c(0,6000))+ geom_rug(alpha = 0.1, sides = "b")+ xlab("Temperature")
p3 <- ggplot(days_since, aes(x=hum, y=results$hum)) + geom_line() +ylim(c(0,6000))+ geom_rug(alpha = 0.1, sides = "b")+ xlab("Humidity")
p4 <- ggplot(days_since, aes(x=windspeed, y=results$windspeed)) + geom_line() +ylim(c(0,6000))+ geom_rug(alpha = 0.1, sides = "b")+ xlab("Wind speed")
subplot(p1,p2,p3,p4, shareY = TRUE, shareX = FALSE, titleX = TRUE)
library(tictoc)
sampled <- sample_n(days_since, 40)
temp <- sampled$temp
hum <- sampled$hum
th <- inner_join(data.frame(temp),data.frame(hum), by=character())
th$p <- 0
tic("entra")
for(i in 1:nrow(th)){
r <- days_since
r[["temp"]] <- th[["temp"]][i]
r[["hum"]] <- th[["hum"]][i]
sal <- predict(rf, r)
th[["p"]][i] <- sum(sal) / nr
}
toc()
ggplot(th, aes(x=temp, y=hum)) + geom_tile(aes(fill = p, width = 10, height = 15)) + geom_rug(alpha = 0.01)
d <- read.csv("/Users/cmonserr/OneDrive - UPV/Trabajo_2/Asignaturas/Evaluacion de modelos/Practicas/jane-street-market-prediction/train.csv")
head(mpg)
d <- read.csv("/Users/cmonserr/OneDrive - UPV/Trabajo_2/Asignaturas/Evaluacion de modelos/Practicas/jane-street-market-prediction/train.csv", nrows=1000)
head(d)
d <- read.csv("2015.csv")
setwd("/Users/cmonserr/OneDrive - UPV/Trabajo_2/Asignaturas/Evaluacion de modelos/Practicas/Practica 5")
d <- read.csv("2015.csv")
head(d)
nrow(d)
ggplot(th, aes(x=temp, y=hum)) + geom_tile(aes(fill = p, width = 10, height = 15)) + geom_rug(alpha = 0.01) + xlab("Temperature") + ylab("Humidity") + scale_color_gradient(title = "Number of bikes")
ggplot(th, aes(x=temp, y=hum)) + geom_tile(aes(fill = p, width = 10, height = 15)) + geom_rug(alpha = 0.01) + xlab("Temperature") + ylab("Humidity") + scale_color_gradient("Number of bikes")
ggplot(th, aes(x=temp, y=hum)) + geom_tile(aes(fill = p, width = 10, height = 15)) + geom_rug(alpha = 0.01) + xlab("Temperature") + ylab("Humidity") + scale_color_gradient("Number of bikes")
ggplot(th, aes(x=temp, y=hum)) + geom_tile(aes(fill = p, width = 10, height = 15)) + geom_rug(alpha = 0.01) + xlab("Temperature") + ylab("Humidity") + scale_color_gradient(name = "Number of bikes")
ggplot(th, aes(x=temp, y=hum)) + geom_tile(aes(fill = p, width = 10, height = 15)) + geom_rug(alpha = 0.01) + xlab("Temperature") + ylab("Humidity") + scale_fill_gradient(name = "Number of bikes")
d <- read.csv("kc_house_data.csv")
head(d)
nrow(d)
d <- read.csv("kc_house_data.csv")
sampled <- sample_n(d, 1000)
sampled <- select(sample, bedrooms, bathrooms, sqft_living, sqft_lot, floors, yr_built, price)
d <- read.csv("kc_house_data.csv")
sampled <- sample_n(d, 1000)
sampled <- select(sampled, bedrooms, bathrooms, sqft_living, sqft_lot, floors, yr_built, price)
rf <- randomForest(price~., data=sampled)
results <- select(sampled, bedrooms, bathrooms, sqft_living, floors, cnt)
d <- read.csv("kc_house_data.csv")
sampled <- sample_n(d, 1000)
sampled <- select(sampled, bedrooms, bathrooms, sqft_living, sqft_lot, floors, yr_built, price)
rf <- randomForest(price~., data=sampled)
results <- select(sampled, bedrooms, bathrooms, sqft_living, floors, price)
nr <- nrow(sampled)
for(c in names(results)[1:4])
{
for(i in 1:nr){
r <- sampled
r[[c]] <- sampled[[c]][i]
sal <- predict(rf, r)
results[[c]][i] <- sum(sal) / nr
}
}
p1 <- ggplot(sampled, aes(x=bedrooms, y=results$bedrooms)) + geom_line() +ylim(c(0,6000))+ geom_rug(alpha = 0.1, sides = "b") + ylab("Prediction") + xlab("Bedrooms")
p2 <- ggplot(sampled, aes(x=bathrooms, y=results$bathrooms)) + geom_line() +ylim(c(0,6000))+ geom_rug(alpha = 0.1, sides = "b")+ xlab("Bathrooms")
p3 <- ggplot(sampled, aes(x=sqft_living, y=results$sqft_living)) + geom_line() +ylim(c(0,6000))+ geom_rug(alpha = 0.1, sides = "b")+ xlab("Sqft Living")
p4 <- ggplot(sampled, aes(x=floors, y=results$floors)) + geom_line() +ylim(c(0,6000))+ geom_rug(alpha = 0.1, sides = "b")+ xlab("Floors")
subplot(p1,p2,p3,p4, shareY = TRUE, shareX = FALSE, titleX = TRUE)
p1 <- ggplot(sampled, aes(x=bedrooms, y=results$bedrooms)) + geom_line() + geom_rug(alpha = 0.1, sides = "b") + ylab("Prediction") + xlab("Bedrooms")
p2 <- ggplot(sampled, aes(x=bathrooms, y=results$bathrooms)) + geom_line() + geom_rug(alpha = 0.1, sides = "b")+ xlab("Bathrooms")
p3 <- ggplot(sampled, aes(x=sqft_living, y=results$sqft_living)) + geom_line() + geom_rug(alpha = 0.1, sides = "b")+ xlab("Sqft Living")
p4 <- ggplot(sampled, aes(x=floors, y=results$floors)) + geom_line() + geom_rug(alpha = 0.1, sides = "b")+ xlab("Floors")
subplot(p1,p2,p3,p4, shareY = TRUE, shareX = FALSE, titleX = TRUE)
p1 <- ggplot(sampled, aes(x=bedrooms, y=results$bedrooms)) + geom_line() + geom_rug(alpha = 0.1, sides = "b") + ylab("Prediction") + xlab("Bedrooms")
p2 <- ggplot(sampled, aes(x=bathrooms, y=results$bathrooms)) + geom_line() + geom_rug(alpha = 0.1, sides = "b")+ xlab("Bathrooms")
p3 <- ggplot(sampled, aes(x=sqft_living, y=results$sqft_living)) + geom_line() + geom_rug(alpha = 0.1, sides = "b")+ xlab("Sqft Living")
p4 <- ggplot(sampled, aes(x=floors, y=results$floors)) + geom_line() + geom_rug(alpha = 0.1, sides = "b")+ xlab("Floors")
subplot(p1,p2,p3,p4, shareX = FALSE, titleX = TRUE)
library(dplyr)
library(plotly)
library(reshape2)
library(lubridate)
library(randomForest)
setwd("/Users/cmonserr/OneDrive - UPV/Trabajo_2/Asignaturas/Evaluacion de modelos/Practicas/Practica 3/Bike-Sharing-Dataset")
days <- read.csv("day.csv")
hour <- read.csv("hour.csv")
days$dteday <- as_date(days$dteday)
days_since <- select(days, workingday, holiday, temp, hum, windspeed, cnt)
days_since$days_since_2011 <- int_length(interval(ymd("2011-01-01"), days$dteday)) / (3600*24)
days_since$SUMMER <- ifelse(days$season == 3, 1, 0)
days_since$FALL <- ifelse(days$season == 4, 1, 0)
days_since$WINTER <- ifelse(days$season == 1, 1, 0)
days_since$MISTY <- ifelse(days$weathersit == 2, 1, 0)
days_since$RAIN <- ifelse(days$weathersit == 3 | days$weathersit == 4, 1, 0)
days_since$temp <- days_since$temp * 47 - 8
days_since$hum <- days_since$hum * 100
days_since$windspeed <- days_since$windspeed * 67
rf <- randomForest(cnt~., data=days_since)
results <- select(days_since, days_since_2011, temp, hum, windspeed, cnt)
nr <- nrow(days_since)
for(c in names(results)[1:4])
{
for(i in 1:nr){
r <- days_since
r[[c]] <- days_since[[c]][i]
sal <- predict(rf, r)
results[[c]][i] <- sum(sal) / nr
}
}
library(dplyr)
library(plotly)
library(reshape2)
library(lubridate)
library(randomForest)
setwd("/Users/cmonserr/OneDrive - UPV/Trabajo_2/Asignaturas/Evaluacion de modelos/Practicas/Practica 3/Bike-Sharing-Dataset")
days <- read.csv("day.csv")
hour <- read.csv("hour.csv")
days$dteday <- as_date(days$dteday)
days_since <- select(days, workingday, holiday, temp, hum, windspeed, cnt)
days_since$days_since_2011 <- int_length(interval(ymd("2011-01-01"), days$dteday)) / (3600*24)
days_since$SUMMER <- ifelse(days$season == 3, 1, 0)
days_since$FALL <- ifelse(days$season == 4, 1, 0)
days_since$WINTER <- ifelse(days$season == 1, 1, 0)
days_since$MISTY <- ifelse(days$weathersit == 2, 1, 0)
days_since$RAIN <- ifelse(days$weathersit == 3 | days$weathersit == 4, 1, 0)
days_since$temp <- days_since$temp * 47 - 8
days_since$hum <- days_since$hum * 100
days_since$windspeed <- days_since$windspeed * 67
rf <- randomForest(cnt~., data=days_since)
results <- select(days_since, days_since_2011, temp, hum, windspeed, cnt)
nr <- nrow(days_since)
for(c in names(results)[1:4])
{
for(i in 1:nr){
r <- days_since
r[[c]] <- days_since[[c]][i]
sal <- predict(rf, r)
results[[c]][i] <- sum(sal) / nr
}
}
p1 <- ggplot(days_since, aes(x=days_since_2011, y=results$days_since_2011)) + geom_line() +ylim(c(0,6000))+ geom_rug(alpha = 0.1, sides = "b") + ylab("Prediction") + xlab("Days since 2011")
p2 <- ggplot(days_since, aes(x=temp, y=results$temp)) + geom_line() +ylim(c(0,6000))+ geom_rug(alpha = 0.1, sides = "b")+ xlab("Temperature")
p3 <- ggplot(days_since, aes(x=hum, y=results$hum)) + geom_line() +ylim(c(0,6000))+ geom_rug(alpha = 0.1, sides = "b")+ xlab("Humidity")
p4 <- ggplot(days_since, aes(x=windspeed, y=results$windspeed)) + geom_line() +ylim(c(0,6000))+ geom_rug(alpha = 0.1, sides = "b")+ xlab("Wind speed")
subplot(p1,p2,p3,p4, shareY = TRUE, shareX = FALSE, titleX = TRUE)
library(tictoc)
sampled <- sample_n(days_since, 40)
temp <- sampled$temp
hum <- sampled$hum
th <- inner_join(data.frame(temp),data.frame(hum), by=character())
th$p <- 0
tic("entra")
for(i in 1:nrow(th)){
r <- days_since
r[["temp"]] <- th[["temp"]][i]
r[["hum"]] <- th[["hum"]][i]
sal <- predict(rf, r)
th[["p"]][i] <- sum(sal) / nr
}
toc()
ggplot(th, aes(x=temp, y=hum)) + geom_tile(aes(fill = p, width = 10, height = 15)) + geom_rug(alpha = 0.01) + xlab("Temperature") + ylab("Humidity") + scale_fill_gradient(name = "Number of bikes")
setwd("/Users/cmonserr/OneDrive - UPV/Trabajo_2/Asignaturas/Evaluacion de modelos/Practicas/Practica 5")
d <- read.csv("kc_house_data.csv")
sampled <- sample_n(d, 1000)
sampled <- select(sampled, bedrooms, bathrooms, sqft_living, sqft_lot, floors, yr_built, price)
rf <- randomForest(price~., data=sampled)
results <- select(sampled, bedrooms, bathrooms, sqft_living, floors, price)
nr <- nrow(sampled)
for(c in names(results)[1:4])
{
for(i in 1:nr){
r <- sampled
r[[c]] <- sampled[[c]][i]
sal <- predict(rf, r)
results[[c]][i] <- sum(sal) / nr
}
}
p1 <- ggplot(sampled, aes(x=bedrooms, y=results$bedrooms)) + geom_line() + geom_rug(alpha = 0.1, sides = "b") + ylab("Prediction") + xlab("Bedrooms")
p2 <- ggplot(sampled, aes(x=bathrooms, y=results$bathrooms)) + geom_line() + geom_rug(alpha = 0.1, sides = "b")+ xlab("Bathrooms")
p3 <- ggplot(sampled, aes(x=sqft_living, y=results$sqft_living)) + geom_line() + geom_rug(alpha = 0.1, sides = "b")+ xlab("Sqft Living")
p4 <- ggplot(sampled, aes(x=floors, y=results$floors)) + geom_line() + geom_rug(alpha = 0.1, sides = "b")+ xlab("Floors")
subplot(p1,p2,p3,p4, shareX = FALSE, titleX = TRUE)
library(dplyr)
library(plotly)
library(reshape2)
library(lubridate)
library(randomForest)
#days <- read.csv("day.csv")
#hour <- read.csv("hour.csv")
days$dteday <- as_date(days$dteday)
library(dplyr)
library(plotly)
library(reshape2)
library(lubridate)
library(randomForest)
#days <- read.csv("day.csv")
#hour <- read.csv("hour.csv")
# sampled <- sample_n(......, 40)
#d <- read.csv("kc_house_data.csv")
#sampled <- sample_n(d, 1000)
library(dplyr)
library(plotly)
library(reshape2)
library(lubridate)
library(randomForestSRC)
#setwd("/Users/cmonserr/OneDrive - UPV/Trabajo_2/Asignaturas/Evaluacion de modelos/Practicas/Practica 3/Bike-Sharing-Dataset")
days <- read.csv("day.csv")
hour <- read.csv("hour.csv")
days$dteday <- as_date(days$dteday)
days_since <- select(days, workingday, holiday, temp, hum, windspeed, cnt)
days_since$days_since_2011 <- int_length(interval(ymd("2011-01-01"), days$dteday)) / (3600*24)
days_since$SUMMER <- ifelse(days$season == 3, 1, 0)
days_since$FALL <- ifelse(days$season == 4, 1, 0)
days_since$WINTER <- ifelse(days$season == 1, 1, 0)
days_since$MISTY <- ifelse(days$weathersit == 2, 1, 0)
days_since$RAIN <- ifelse(days$weathersit == 3 | days$weathersit == 4, 1, 0)
days_since$temp <- days_since$temp * 47 - 8
days_since$hum <- days_since$hum * 100
days_since$windspeed <- days_since$windspeed * 67
rf <- rfsrc(cnt~., data=days_since)
results <- select(days_since, days_since_2011, temp, hum, windspeed, cnt)
nr <- nrow(days_since)
for(c in names(results)[1:4])
{
for(i in 1:nr){
r <- days_since
r[[c]] <- days_since[[c]][i]
sal <- predict(rf, r)$predicted
results[[c]][i] <- sum(sal) / nr
}
}
library(dplyr)
library(plotly)
library(reshape2)
library(lubridate)
library(randomForestSRC)
#setwd("/Users/cmonserr/OneDrive - UPV/Trabajo_2/Asignaturas/Evaluacion de modelos/Practicas/Practica 3/Bike-Sharing-Dataset")
days <- read.csv("day.csv")
hour <- read.csv("hour.csv")
days$dteday <- as_date(days$dteday)
days_since <- select(days, workingday, holiday, temp, hum, windspeed, cnt)
days_since$days_since_2011 <- int_length(interval(ymd("2011-01-01"), days$dteday)) / (3600*24)
days_since$SUMMER <- ifelse(days$season == 3, 1, 0)
days_since$FALL <- ifelse(days$season == 4, 1, 0)
days_since$WINTER <- ifelse(days$season == 1, 1, 0)
days_since$MISTY <- ifelse(days$weathersit == 2, 1, 0)
days_since$RAIN <- ifelse(days$weathersit == 3 | days$weathersit == 4, 1, 0)
days_since$temp <- days_since$temp * 47 - 8
days_since$hum <- days_since$hum * 100
days_since$windspeed <- days_since$windspeed * 67
rf <- rfsrc(cnt~., data=days_since)
results <- select(days_since, days_since_2011, temp, hum, windspeed, cnt)
nr <- nrow(days_since)
for(c in names(results)[1:4])
{
for(i in 1:nr){
r <- days_since
r[[c]] <- days_since[[c]][i]
sal <- predict(rf, r)$predicted
results[[c]][i] <- sum(sal) / nr
}
}
p = ggplot(days_since,aes(x=temp, y=results$temp))
p1 = p + geom_line(y = days_since_2011) + geom_rug(inherit.aes=TRUE)
View(days_since)
p = ggplot(days_since,aes(x=temp, y=results$temp))
p1 = p + geom_line(y = days_since$days_since_2011) + geom_rug(inherit.aes=TRUE)
p1
p = ggplot(days_since,aes(x=temp, y=results$temp))
p1 = p + geom_line(y = days_since$days_since_2011) + geom_rug(mapping=days_since$days_since_2011)
p = ggplot(days_since,aes(x=temp, y=results$temp))
p1 = p + geom_line(y = days_since$days_since_2011) + geom_rug(mapping=aes(x = days_since$days_since_2011))
p1
p = ggplot(days_since,aes(x=temp, y=results$temp))
p1 = p + geom_line(y = days_since$days_since_2011) + geom_rug(mapping=aes(x =days_since_2011))
p1
p = ggplot(days_since,aes(x=temp, y=results$temp))
p1 = p + geom_line(y = days_since$days_since_2011)
p1
View(results)
p = ggplot(days_since,aes(x=temp, y=results$temp))
p1 = p + geom_line(y = results$days_since_2011)
p1
p = ggplot(days_since,aes(x=temp, y=results$temp))
p1 = p +  geom_line(size=1, colour="red")
p1
p1 = ggplot(days_since,aes(x=temp, y=results$temp))  +  geom_line(size=1)
p1
p2 = ggplot(days_since,aes(x=temp, y=results$days_since_2011))  +  geom_line(size=1)
p2
p2 = p + geom_line(aes(y=results$days_since_2011))
p2
p2 = p + geom_line(aes(y=results$humidity))
p2
p2 = p + geom_line(aes(y=results$humidity))
View(results)
p2 = p + geom_line(aes(y=results$hum))
p2
library(dplyr)
library(plotly)
library(reshape2)
library(lubridate)
library(randomForestSRC)
#setwd("/Users/cmonserr/OneDrive - UPV/Trabajo_2/Asignaturas/Evaluacion de modelos/Practicas/Practica 3/Bike-Sharing-Dataset")
days <- read.csv("day.csv")
hour <- read.csv("hour.csv")
days$dteday <- as_date(days$dteday)
days_since <- select(days, workingday, holiday, temp, hum, windspeed, cnt)
days_since$days_since_2011 <- int_length(interval(ymd("2011-01-01"), days$dteday)) / (3600*24)
days_since$SUMMER <- ifelse(days$season == 3, 1, 0)
days_since$FALL <- ifelse(days$season == 4, 1, 0)
days_since$WINTER <- ifelse(days$season == 1, 1, 0)
days_since$MISTY <- ifelse(days$weathersit == 2, 1, 0)
days_since$RAIN <- ifelse(days$weathersit == 3 | days$weathersit == 4, 1, 0)
days_since$temp <- days_since$temp * 47 - 8
days_since$hum <- days_since$hum * 100
days_since$windspeed <- days_since$windspeed * 67
rf <- rfsrc(cnt~., data=days_since)
results <- select(days_since, days_since_2011, temp, hum, windspeed, cnt)
nr <- nrow(days_since)
for(c in names(results)[1:4])
{
for(i in 1:nr){
r <- days_since
r[[c]] <- days_since[[c]][i]
sal <- predict(rf, r)$predicted
results[[c]][i] <- sum(sal) / nr
}
}
p = ggplot(days_since,aes(x=temp, y=results$temp))
p2 = p + geom_line(aes(y=results$windspeed))
p2
p = ggplot(days_since,aes(x=temp))
p1 = p + geom_line(aes(y=results$temp), size=1)
p2 = p + geom_line(aes(y=results$windspeed))
p1
p2
p = ggplot(days_since,aes(x=temp, y = results$temp))
p1 = p + geom_line(size=1)
p1
p = ggplot(days_since,aes(x=temp, y=results$temp))
p1 = p + geom_line(size=1)
p1
p = ggplot(days_since,aes(x=temp, y=results$temp))
p1 = p + geom_line(size=1)
p1
p = ggplot(days_since, aes(x=temp, y=results$temp)) + geom_line(size=1)
p
p1 = ggplot(days_since,aes(x=temp, y=results$temp))  +  geom_line(size=1)
p2 = ggplot(days_since,aes(x=temp, y=results$days_since_2011))  +  geom_line(size=1)
p1
p2
p1 = ggplot(days_since,aes(x=temp, y=results$temp)) + geom_line(size=1)
p2 = ggplot(days_since,aes(x=temp, y=results$days_since_2011)) + geom_line(size=1)
p1
p2
p1 = ggplot(days_since,aes(x=temp, y=results$temp)) + geom_line(size=1)
p1 = ggplot(days_since,aes(x=temp, y=results$temp)) + geom_line(size=1)
p1
p1 = ggplot(days_since,aes(x=temp, y=results$temp)) + geom_line(aes(y = results$temp),size=1)
p1
temp
temp
View(days_since)
p1 = ggplot(days_since, aes(x=temp,y=results$temp)) + geom_line(aes(y=cnt))
p1
View(results)
p1 = ggplot(days_since, aes(x=temp,y=results$temp)) + geom_line(aes(y=results$cnt))
p1
library(dplyr)
library(plotly)
library(reshape2)
library(lubridate)
library(randomForestSRC)
#setwd("/Users/cmonserr/OneDrive - UPV/Trabajo_2/Asignaturas/Evaluacion de modelos/Practicas/Practica 3/Bike-Sharing-Dataset")
days <- read.csv("day.csv")
hour <- read.csv("hour.csv")
days$dteday <- as_date(days$dteday)
days_since <- select(days, workingday, holiday, temp, hum, windspeed, cnt)
days_since$days_since_2011 <- int_length(interval(ymd("2011-01-01"), days$dteday)) / (3600*24)
days_since$SUMMER <- ifelse(days$season == 3, 1, 0)
days_since$FALL <- ifelse(days$season == 4, 1, 0)
days_since$WINTER <- ifelse(days$season == 1, 1, 0)
days_since$MISTY <- ifelse(days$weathersit == 2, 1, 0)
days_since$RAIN <- ifelse(days$weathersit == 3 | days$weathersit == 4, 1, 0)
days_since$temp <- days_since$temp * 47 - 8
days_since$hum <- days_since$hum * 100
days_since$windspeed <- days_since$windspeed * 67
rf <- rfsrc(cnt~., data=days_since)
results <- select(days_since, days_since_2011, temp, hum, windspeed, cnt)
nr <- nrow(days_since)
for(c in names(results)[1:4])
{
for(i in 1:nr){
r <- days_since
r[[c]] <- days_since[[c]][i]
sal <- predict(rf, r)$predicted
results[[c]][i] <- sum(sal) / nr
}
}
p1 = ggplot(days_since, aes(x=temp,y=results$temp)) + geom_line(size=1)
p1
p2 = ggplot(days_since,aes(x=temp, y=results$days_since_2011)) + geom_line(size=1)
p2
p1 = ggplot(days_since, aes(x=temp,y=results$temp)) + geom_line(size=1)
p1
p2 = ggplot(days_since,aes(x=temp, y=results$days_since_2011)) + geom_line(size=1)
p2
p2 = ggplot(days_since,aes(x=days_since_2011, y=results$days_since_2011)) + geom_line()
p2
p1 = ggplot(days_since, aes(x=temp,y=results$temp)) + geom_line(size=1)
p2 = ggplot(days_since,aes(x=days_since_2011, y=results$days_since_2011)) + geom_line()
p3 = ggplot(days_since,aes(x=hum, y=results$hum)) + geom_line() ## + geom_rug()
p4 = ggplot(days_since,aes(x=windspeed, y=results$windspeed)) + geom_line() ## + geom_rug()
subplot(p1,p2,p3,p4)
p1 = ggplot(days_since, aes(x=temp,y=results$temp)) + geom_line(size=1) + ylim(0, 6050)
p2 = ggplot(days_since,aes(x=days_since_2011, y=results$days_since_2011)) + geom_line() + ylim(0, 6050)
p3 = ggplot(days_since,aes(x=hum, y=results$hum)) + geom_line() + ylim(0, 6050) ## + geom_rug()
p4 = ggplot(days_since,aes(x=windspeed, y=results$windspeed)) + geom_line() + ylim(0, 6050) ## + geom_rug()
subplot(p1,p2,p3,p4)
p1 = ggplot(days_since, aes(x=temp,y=results$temp)) + geom_line() + ylim(0, 6050)
p2 = ggplot(days_since,aes(x=days_since_2011, y=results$days_since_2011)) + geom_line() + ylim(0, 6050)
p3 = ggplot(days_since,aes(x=hum, y=results$hum)) + geom_line() + ylim(0, 6050) ## + geom_rug()
p4 = ggplot(days_since,aes(x=windspeed, y=results$windspeed)) + geom_line() + ylim(0, 6050) ## + geom_rug()
subplot(p1,p2,p3,p4)
install.packages("patchwork")
library(patchwork)
p1 + p2+ p3 + p4 + plot_layout(ncol=4)
library(patchwork)
p1 + p2+ p3 + p4 + plot_layout(ncol=4)
subplot(p1,p2,p3,p4)
library(patchwork)
p1 + p2+ p3 + p4 + plot_layout(ncol=4)
